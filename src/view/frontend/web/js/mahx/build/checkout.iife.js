(function(){"use strict";class p{static toJson(e,t){t=p.merge(p.defaultOptionsToJson,t);function i(c){if(typeof t.inputFilter=="function"&&t.inputFilter(c)!==!0||!t.includeDisabled&&c.disabled)return!1;const g=(c.type||"text").toLowerCase();return!(!t.includeButtonValues&&(c instanceof HTMLButtonElement||p.buttonInputTypes.indexOf(g)>-1)||typeof t.uncheckedValue>"u"&&p.checkedInputTypes.indexOf(g)>-1&&!c.checked)}const s=p.getFieldTree(e,i);let l=t.flatList?[]:{};const r=[];function n(c,g){for(let b in c){const f=c[b],E=t.flatList?f.name:b;if(f.type==="nested"){t.flatList?n(f.tree,g):(g[b]={},n(f.tree,g[b]));continue}const m=f.input,F=f.inputType;if(F==="file"){t.filesCallback&&r.push({object:g,key:E,input:m});continue}let I=null;if(f.type==="radio"){for(let k=0;k<f.inputs.length;k++){const A=f.inputs[k];if(A.checked){I=A.value;break}}I===null&&(I=t.uncheckedValue)}else if(F==="checkbox")I=m.checked?m.value:t.uncheckedValue;else if(m instanceof HTMLSelectElement){let k=[];for(let A=0;A<m.options.length;A++){let O=m.options[A];O.selected&&k.push((typeof O.value<"u"?O.value:O.text).toString())}m.multiple?I=k:I=k.length?k[0]:null}else I=m.value;t.flatList?g.push([f.name,I]):g[E]=I}}function d(c){if(p.isObject(c)){let g=0,b=!0;for(let f in c)p.isObject(c[f])&&!(c[f]instanceof Element)&&(c[f]=d(c[f])),parseInt(f)!==g&&(b=!1),g++;if(b){let f=[];for(let E in c)f.push(c[E]);return f}}return c}function a(){return t.arrayify&&(l=d(l)),t.skipEmpty&&(l=u(l)||(t.flatList?[]:{})),l}function u(c,g){const b=p.isArray(c);let f=b?[]:{},E=0;for(let m in c){let F=c[m];t.flatList&&!g&&(F=F[1]),!(F==null||F==="")&&((p.isObject(F)||p.isArray(F))&&(F=u(F,(g||0)+1)||""),!(typeof F!="object"&&p.stringify(F)==="")&&(b?f.push(t.flatList&&!g?[c[m][0],F]:F):f[m]=F,E++))}return E?f:null}if(n(s,l),r.length){let c=0,g=0;for(let b=0;b<r.length;b++){let f=r[b],E=f.object;g+=f.input.files.length;for(let m=0;m<f.input.files.length;m++){let F=f.input.files[m],I=new FileReader;I.onload=function(){f.input.multiple?(p.isArray(E[f.key])||(E[f.key]=[]),E[f.key].push(I.result)):E[f.key]=I.result,c++,c===g&&t.filesCallback(a())},I[t.fileReaderFunction](F)}}return null}else if(t.filesCallback)return t.filesCallback(a()),null;return a()}static fromJson(e,t,i,s){if(!p.isObject(t)&&!p.isArray(t))return;i=p.merge(p.defaultOptionsFromJson,i);const l=p.getFieldTree(e),r={};i.clearOthers&&p.clear(e),i.resetOthers&&p.reset(e);function n(d,a){if(!(!p.isObject(a)&&!p.isArray(a)))for(let u in d){const c=d[u],g=i.flatList?c.name:u;if(c.type==="nested"){if(i.flatList)n(c.tree,a);else if(typeof a[g]=="object"){const b=a[g];let f=c.tree;if(p.isArray(b)){f={};for(let E in c.tree){const m=c.tree[E];if(m.autoIncrementInputs&&m.input.type.toLowerCase()==="checkbox"&&b.indexOf(m.input.value)>-1){m.input.checked=!0;continue}f[E]=m}}n(f,b)}continue}if(i.flatList){for(let b in a){const f=a[b];if(f&&f[0]===c.name&&r[c.name]!==b){r[c.name]=b,p.setInputValue(c,f[1],i.triggerChangeEvent);break}}continue}typeof a[g]>"u"||p.setInputValue(c,a[g]||null,i.triggerChangeEvent)}}n(l,t)}static reset(e){const t=p.getFieldTree(e);function i(s){for(let l in s){const r=s[l];if(r.type==="nested"){i(r.tree);continue}if(r.type==="radio"){for(let d=0;d<r.inputs.length;d++){const a=r.inputs[d];a.checked=a.defaultChecked}continue}if(r.inputType&&p.buttonInputTypes.indexOf(r.inputType)>-1)continue;const n=r.input;if(p.checkedInputTypes.indexOf(r.inputType)>-1)n.checked=n.defaultChecked;else if(n instanceof HTMLSelectElement){const d=n.querySelectorAll("option");for(let a=0;a<d.length;a++){const u=d[a];u.selected=u.defaultSelected}}else n.getAttribute("value")?n.value=n.getAttribute("value"):(typeof n.defaultValue=="string"||typeof n.defaultValue=="number")&&(n.value=n.defaultValue)}}i(t)}static clear(e){const t=p.getFieldTree(e);function i(s){for(let l in s){const r=s[l];if(r.type==="nested"){i(r.tree);continue}r.input&&p.buttonInputTypes.indexOf(r.inputType)>-1||p.setInputValue(r,null)}}i(t)}static setInputValue(e,t,i){const s=i?function(d){let a=null;typeof Event=="function"?a=new Event("change",{bubbles:!0}):(a=document.createEvent("Event"),a.initEvent("change",!0,!0)),d.dispatchEvent(a)}:null;if(e.type==="radio"){let d=[];for(let a=0;a<e.inputs.length;a++){const u=e.inputs[a];if(u.checked&&d.push(u),u.checked=!1,t!==null&&p.stringify(u.value)===p.stringify(t)){u.checked||d.push(u),u.checked=!0;break}}if(s)for(let a in d)s(d[a]);return}const l=e.input,r=e.inputType;if(r==="file")return;let n=!1;if(r==="checkbox")t=t===!0||t!==null&&p.stringify(l.value)===p.stringify(t),t!==l.checked&&(n=!0),l.checked=t;else if(l instanceof HTMLSelectElement){let d=t;d==null?d=[]:p.isObject(d)?d=Object.values(d):p.isArray(d)||(d=[d]);const a=[],u=[];for(let c=0;c<l.options.length;c++){const g=l.options[c],b=(typeof g.value<"u"?g.value:g.text).toString();g.selected!==!1&&a.push(c),g.selected=!1;for(let f=0;f<d.length;f++)if(b===p.stringify(d[f])){g.selected=!0;break}g.selected!==!1&&u.push(c)}n=JSON.stringify(a)!==JSON.stringify(u)}else l.value!==t&&(n=!0),l.value=t;n&&s&&s(l)}static stringify(e){return e===void 0||typeof e=="object"?"":typeof e=="boolean"?e?"1":"0":e+""}static getFieldTree(e,t){if(e=p.getElement(e),!e)return[];let i=e.querySelectorAll("select, textarea, input, button"),s={},l={};for(let r=0;r<i.length;r++){const n=i[r];if(!n.name||n.name.length===0||t&&t(n)!==!0)continue;const d=(n.type||"text").toLowerCase();let a=n.name;const u=n.name.replace(/\]/g,"").split("["),c=a.substr(-2)==="[]";c&&(n instanceof HTMLSelectElement&&n.multiple||d==="radio")&&u.pop();const g=u.length;let b=s,f="";for(let E=0;E<g;E++){let m=u[E],F=f?f+"["+m+"]":m;m===""&&(typeof l[F]>"u"&&(l[F]=0),m=l[F].toString(),l[F]++),f=f?f+"["+m+"]":m,g-1===E?(n.type||"text").toLowerCase()==="radio"?(typeof b[m]>"u"&&(b[m]={type:"radio",name:n.name,inputType:d,inputs:[],autoIncrementInputs:0}),c&&(b[m].autoIncrementInputs=1),b[m].inputs.push(n)):b[m]={type:"default",name:n.name,inputType:d,input:n,autoIncrementInputs:c?1:0}:((typeof b[m]>"u"||typeof b[m].tree>"u")&&(b[m]={type:"nested",tree:{}}),b=b[m].tree)}}return s}static isObject(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)!=="[object Array]"}static isArray(e){return Array.isArray(e)}static getElement(e){return typeof e=="string"?document.querySelector(e):e instanceof HTMLElement?e:typeof jQuery<"u"&&e instanceof jQuery||typeof $<"u"&&e instanceof $?e[0]:(console.warn("FormDataJson: Unsupported element passed. Supported is HTMLElement, a string query selector, JQuery or $ object"),null)}static merge(e,t){let i={};for(let s in e)i[s]=e[s];for(let s in t)i[s]=t[s];return i}}p.defaultOptionsToJson={includeDisabled:!1,includeButtonValues:!1,uncheckedValue:void 0,inputFilter:null,flatList:!1,skipEmpty:!1,filesCallback:null,fileReaderFunction:"readAsDataURL",arrayify:!0},p.defaultOptionsFromJson={flatList:!1,clearOthers:!1,resetOthers:!1,triggerChangeEvent:!1},p.buttonInputTypes=["button","submit","reset","image"],p.checkedInputTypes=["checkbox","radio"];var D=Object.defineProperty,J=(o,e,t)=>e in o?D(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,L=(o,e,t)=>(J(o,typeof e!="symbol"?e+"":e,t),t);const R=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,ee=/^-?[0-9]\d*$/,te=/^(?=.*[A-Za-z])(?=.*\d).{8,}$/,ie=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/,se=o=>{let e=o;return typeof o=="string"&&(e=o.trim()),!e},re=o=>R.test(o),le=(o,e)=>o.length>e,ne=(o,e)=>o.length<e,oe=o=>typeof o!="string"?!1:!isNaN(+o)&&!isNaN(parseFloat(o)),ae=o=>ee.test(o),de=o=>te.test(o),ue=o=>ie.test(o),ce=(o,e)=>o>e,fe=(o,e)=>o<e,M=o=>typeof o!="string"||o==="";var y=(o=>(o.Required="required",o.Email="email",o.MinLength="minLength",o.MaxLength="maxLength",o.Password="password",o.Number="number",o.Integer="integer",o.MaxNumber="maxNumber",o.MinNumber="minNumber",o.StrongPassword="strongPassword",o.CustomRegexp="customRegexp",o.MinFilesCount="minFilesCount",o.MaxFilesCount="maxFilesCount",o.Files="files",o))(y||{}),_=(o=>(o.Required="required",o))(_||{}),Z=(o=>(o.Label="label",o.LabelArrow="labelArrow",o))(Z||{});const U=[{key:y.Required,dict:{en:"The field is required"}},{key:y.Email,dict:{en:"Email has invalid format"}},{key:y.MaxLength,dict:{en:"The field must contain a maximum of :value characters"}},{key:y.MinLength,dict:{en:"The field must contain a minimum of :value characters"}},{key:y.Password,dict:{en:"Password must contain minimum eight characters, at least one letter and one number"}},{key:y.StrongPassword,dict:{en:"Password should contain minimum eight characters, at least one uppercase letter, one lowercase letter, one number and one special character"}},{key:y.Number,dict:{en:"Value should be a number"}},{key:y.MaxNumber,dict:{en:"Number should be less or equal than :value"}},{key:y.MinNumber,dict:{en:"Number should be more or equal than :value"}},{key:y.MinFilesCount,dict:{en:"Files count should be more or equal than :value"}},{key:y.MaxFilesCount,dict:{en:"Files count should be less or equal than :value"}},{key:y.Files,dict:{en:"Uploaded files have one or several invalid properties (extension/size/type etc)."}}],he="Value is incorrect",P=o=>typeof o=="object"&&o!==null&&"then"in o&&typeof o.then=="function",be=o=>{let e=o;const t=[];for(;e;)t.unshift(e),e=e.parentNode;return t},ge=(o,e)=>{const t=[...e].reverse();for(let i=0,s=t.length;i<s;++i){const l=t[i];for(const r in o){const n=o[r];if(n.groupElem===l)return[r,n]}}return null},x=o=>Array.isArray(o)?o.filter(e=>e.length>0):typeof o=="string"&&o.trim()?[...o.split(" ").filter(e=>e.length>0)]:[],N=o=>o instanceof Element||o instanceof HTMLDocument,pe=".just-validate-error-label[data-tooltip=true]{position:fixed;padding:4px 8px;background:#423f3f;color:#fff;white-space:nowrap;z-index:10;border-radius:4px;transform:translateY(-5px)}.just-validate-error-label[data-tooltip=true]:before{content:'';width:0;height:0;border-left:solid 5px transparent;border-right:solid 5px transparent;border-bottom:solid 5px #423f3f;position:absolute;z-index:3;display:block;bottom:-5px;transform:rotate(180deg);left:calc(50% - 5px)}.just-validate-error-label[data-tooltip=true][data-direction=left]{transform:translateX(-5px)}.just-validate-error-label[data-tooltip=true][data-direction=left]:before{right:-7px;bottom:auto;left:auto;top:calc(50% - 2px);transform:rotate(90deg)}.just-validate-error-label[data-tooltip=true][data-direction=right]{transform:translateX(5px)}.just-validate-error-label[data-tooltip=true][data-direction=right]:before{right:auto;bottom:auto;left:-7px;top:calc(50% - 2px);transform:rotate(-90deg)}.just-validate-error-label[data-tooltip=true][data-direction=bottom]{transform:translateY(5px)}.just-validate-error-label[data-tooltip=true][data-direction=bottom]:before{right:auto;bottom:auto;left:calc(50% - 5px);top:-5px;transform:rotate(0)}",q=5,z={errorFieldStyle:{color:"#b81111",border:"1px solid #B81111"},errorFieldCssClass:"just-validate-error-field",successFieldCssClass:"just-validate-success-field",errorLabelStyle:{color:"#b81111"},errorLabelCssClass:"just-validate-error-label",successLabelCssClass:"just-validate-success-label",focusInvalidField:!0,lockForm:!0,testingMode:!1,validateBeforeSubmitting:!1,submitFormAutomatically:!1};class me{constructor(e,t,i){L(this,"form",null),L(this,"fields",{}),L(this,"groupFields",{}),L(this,"errors",{}),L(this,"isValid",!1),L(this,"isSubmitted",!1),L(this,"globalConfig",z),L(this,"errorLabels",{}),L(this,"successLabels",{}),L(this,"eventListeners",[]),L(this,"dictLocale",U),L(this,"currentLocale","en"),L(this,"customStyleTags",{}),L(this,"onSuccessCallback"),L(this,"onFailCallback"),L(this,"onValidateCallback"),L(this,"tooltips",[]),L(this,"lastScrollPosition"),L(this,"isScrollTick"),L(this,"fieldIds",new Map),L(this,"getKeyByFieldSelector",s=>this.fieldIds.get(s)),L(this,"getFieldSelectorByKey",s=>{for(const[l,r]of this.fieldIds)if(s===r)return l}),L(this,"getCompatibleFields",()=>{const s={};return Object.keys(this.fields).forEach(l=>{let r=l;const n=this.getFieldSelectorByKey(l);typeof n=="string"&&(r=n),s[r]={...this.fields[l]}}),s}),L(this,"setKeyByFieldSelector",s=>{if(this.fieldIds.has(s))return this.fieldIds.get(s);const l=String(this.fieldIds.size+1);return this.fieldIds.set(s,l),l}),L(this,"refreshAllTooltips",()=>{this.tooltips.forEach(s=>{s.refresh()})}),L(this,"handleDocumentScroll",()=>{this.lastScrollPosition=window.scrollY,this.isScrollTick||(window.requestAnimationFrame(()=>{this.refreshAllTooltips(),this.isScrollTick=!1}),this.isScrollTick=!0)}),L(this,"formSubmitHandler",s=>{s.preventDefault(),this.isSubmitted=!0,this.validateHandler(s)}),L(this,"handleFieldChange",s=>{let l;for(const r in this.fields)if(this.fields[r].elem===s){l=r;break}l&&(this.fields[l].touched=!0,this.validateField(l,!0))}),L(this,"handleGroupChange",s=>{let l;for(const r in this.groupFields)if(this.groupFields[r].elems.find(d=>d===s)){l=r;break}l&&(this.groupFields[l].touched=!0,this.validateGroup(l,!0))}),L(this,"handlerChange",s=>{s.target&&(this.handleFieldChange(s.target),this.handleGroupChange(s.target),this.renderErrors())}),this.initialize(e,t,i)}initialize(e,t,i){if(this.form=null,this.errors={},this.isValid=!1,this.isSubmitted=!1,this.globalConfig=z,this.errorLabels={},this.successLabels={},this.eventListeners=[],this.customStyleTags={},this.tooltips=[],this.currentLocale="en",typeof e=="string"){const s=document.querySelector(e);if(!s)throw Error(`Form with ${e} selector not found! Please check the form selector`);this.setForm(s)}else if(e instanceof HTMLFormElement)this.setForm(e);else throw Error("Form selector is not valid. Please specify a string selector or a DOM element.");if(this.globalConfig={...z,...t},i&&(this.dictLocale=[...i,...U]),this.isTooltip()){const s=document.createElement("style");s.textContent=pe,this.customStyleTags[Z.Label]=document.head.appendChild(s),this.addListener("scroll",document,this.handleDocumentScroll)}}getLocalisedString(e,t,i){var s;const l=i??e;let r=(s=this.dictLocale.find(n=>n.key===l))==null?void 0:s.dict[this.currentLocale];if(r||i&&(r=i),r&&t!==void 0)switch(e){case y.MaxLength:case y.MinLength:case y.MaxNumber:case y.MinNumber:case y.MinFilesCount:case y.MaxFilesCount:r=r.replace(":value",String(t))}return r||i||he}getFieldErrorMessage(e,t){const i=typeof e.errorMessage=="function"?e.errorMessage(this.getElemValue(t),this.fields):e.errorMessage;return this.getLocalisedString(e.rule,e.value,i)}getFieldSuccessMessage(e,t){const i=typeof e=="function"?e(this.getElemValue(t),this.fields):e;return this.getLocalisedString(void 0,void 0,i)}getGroupErrorMessage(e){return this.getLocalisedString(e.rule,void 0,e.errorMessage)}getGroupSuccessMessage(e){if(e.successMessage)return this.getLocalisedString(void 0,void 0,e.successMessage)}setFieldInvalid(e,t){this.fields[e].isValid=!1,this.fields[e].errorMessage=this.getFieldErrorMessage(t,this.fields[e].elem)}setFieldValid(e,t){this.fields[e].isValid=!0,t!==void 0&&(this.fields[e].successMessage=this.getFieldSuccessMessage(t,this.fields[e].elem))}setGroupInvalid(e,t){this.groupFields[e].isValid=!1,this.groupFields[e].errorMessage=this.getGroupErrorMessage(t)}setGroupValid(e,t){this.groupFields[e].isValid=!0,this.groupFields[e].successMessage=this.getGroupSuccessMessage(t)}getElemValue(e){switch(e.type){case"checkbox":return e.checked;case"file":return e.files;default:return e.value}}validateGroupRule(e,t,i){switch(i.rule){case _.Required:t.every(s=>!s.checked)?this.setGroupInvalid(e,i):this.setGroupValid(e,i)}}validateFieldRule(e,t,i,s=!1){const l=i.value,r=this.getElemValue(t);if(i.plugin){i.plugin(r,this.getCompatibleFields())||this.setFieldInvalid(e,i);return}switch(i.rule){case y.Required:{se(r)&&this.setFieldInvalid(e,i);break}case y.Email:{if(M(r))break;re(r)||this.setFieldInvalid(e,i);break}case y.MaxLength:{if(l===void 0){console.error(`Value for ${i.rule} rule for [${e}] field is not defined. The field will be always invalid.`),this.setFieldInvalid(e,i);break}if(typeof l!="number"){console.error(`Value for ${i.rule} rule for [${e}] should be a number. The field will be always invalid.`),this.setFieldInvalid(e,i);break}if(M(r))break;le(r,l)&&this.setFieldInvalid(e,i);break}case y.MinLength:{if(l===void 0){console.error(`Value for ${i.rule} rule for [${e}] field is not defined. The field will be always invalid.`),this.setFieldInvalid(e,i);break}if(typeof l!="number"){console.error(`Value for ${i.rule} rule for [${e}] should be a number. The field will be always invalid.`),this.setFieldInvalid(e,i);break}if(M(r))break;ne(r,l)&&this.setFieldInvalid(e,i);break}case y.Password:{if(M(r))break;de(r)||this.setFieldInvalid(e,i);break}case y.StrongPassword:{if(M(r))break;ue(r)||this.setFieldInvalid(e,i);break}case y.Number:{if(M(r))break;oe(r)||this.setFieldInvalid(e,i);break}case y.Integer:{if(M(r))break;ae(r)||this.setFieldInvalid(e,i);break}case y.MaxNumber:{if(l===void 0){console.error(`Value for ${i.rule} rule for [${e}] field is not defined. The field will be always invalid.`),this.setFieldInvalid(e,i);break}if(typeof l!="number"){console.error(`Value for ${i.rule} rule for [${e}] field should be a number. The field will be always invalid.`),this.setFieldInvalid(e,i);break}if(M(r))break;const n=+r;(Number.isNaN(n)||ce(n,l))&&this.setFieldInvalid(e,i);break}case y.MinNumber:{if(l===void 0){console.error(`Value for ${i.rule} rule for [${e}] field is not defined. The field will be always invalid.`),this.setFieldInvalid(e,i);break}if(typeof l!="number"){console.error(`Value for ${i.rule} rule for [${e}] field should be a number. The field will be always invalid.`),this.setFieldInvalid(e,i);break}if(M(r))break;const n=+r;(Number.isNaN(n)||fe(n,l))&&this.setFieldInvalid(e,i);break}case y.CustomRegexp:{if(l===void 0){console.error(`Value for ${i.rule} rule for [${e}] field is not defined. This field will be always invalid.`),this.setFieldInvalid(e,i);return}let n;try{n=new RegExp(l)}catch{console.error(`Value for ${i.rule} rule for [${e}] should be a valid regexp. This field will be always invalid.`),this.setFieldInvalid(e,i);break}const d=String(r);d!==""&&!n.test(d)&&this.setFieldInvalid(e,i);break}case y.MinFilesCount:{if(l===void 0){console.error(`Value for ${i.rule} rule for [${e}] field is not defined. This field will be always invalid.`),this.setFieldInvalid(e,i);break}if(typeof l!="number"){console.error(`Value for ${i.rule} rule for [${e}] field should be a number. The field will be always invalid.`),this.setFieldInvalid(e,i);break}if(Number.isFinite(r==null?void 0:r.length)&&r.length<l){this.setFieldInvalid(e,i);break}break}case y.MaxFilesCount:{if(l===void 0){console.error(`Value for ${i.rule} rule for [${e}] field is not defined. This field will be always invalid.`),this.setFieldInvalid(e,i);break}if(typeof l!="number"){console.error(`Value for ${i.rule} rule for [${e}] field should be a number. The field will be always invalid.`),this.setFieldInvalid(e,i);break}if(Number.isFinite(r==null?void 0:r.length)&&r.length>l){this.setFieldInvalid(e,i);break}break}case y.Files:{if(l===void 0){console.error(`Value for ${i.rule} rule for [${e}] field is not defined. This field will be always invalid.`),this.setFieldInvalid(e,i);return}if(typeof l!="object"){console.error(`Value for ${i.rule} rule for [${e}] field should be an object. This field will be always invalid.`),this.setFieldInvalid(e,i);return}const n=l.files;if(typeof n!="object"){console.error(`Value for ${i.rule} rule for [${e}] field should be an object with files array. This field will be always invalid.`),this.setFieldInvalid(e,i);return}const d=(a,u)=>{const c=Number.isFinite(u.minSize)&&a.size<u.minSize,g=Number.isFinite(u.maxSize)&&a.size>u.maxSize,b=Array.isArray(u.names)&&!u.names.includes(a.name),f=Array.isArray(u.extensions)&&!u.extensions.includes(a.name.split(".")[a.name.split(".").length-1]),E=Array.isArray(u.types)&&!u.types.includes(a.type);return c||g||b||f||E};if(typeof r=="object"&&r!==null)for(let a=0,u=r.length;a<u;++a){const c=r.item(a);if(!c){this.setFieldInvalid(e,i);break}if(d(c,n)){this.setFieldInvalid(e,i);break}}break}default:{if(typeof i.validator!="function"){console.error(`Validator for custom rule for [${e}] field should be a function. This field will be always invalid.`),this.setFieldInvalid(e,i);return}const n=i.validator(r,this.getCompatibleFields());if(typeof n!="boolean"&&typeof n!="function"&&console.error(`Validator return value for [${e}] field should be boolean or function. It will be cast to boolean.`),typeof n=="function")if(s)this.fields[e].asyncCheckPending=!0;else{this.fields[e].asyncCheckPending=!1;const d=n();if(!P(d)){console.error(`Validator function for custom rule for [${e}] field should return a Promise. This field will be always invalid.`),this.setFieldInvalid(e,i);return}return d.then(a=>{a||this.setFieldInvalid(e,i)}).catch(()=>{this.setFieldInvalid(e,i)})}n||this.setFieldInvalid(e,i)}}}isFormValid(){let e=!0;for(let t=0,i=Object.values(this.fields).length;t<i;++t){const s=Object.values(this.fields)[t];if(s.isValid===void 0){e=void 0;break}if(s.isValid===!1){e=!1;break}}for(let t=0,i=Object.values(this.groupFields).length;t<i;++t){const s=Object.values(this.groupFields)[t];if(s.isValid===void 0){e=void 0;break}if(s.isValid===!1){e=!1;break}}return e}validateField(e,t=!1){var i;const s=this.fields[e];s.isValid=!0;const l=[];return[...s.rules].reverse().forEach(r=>{const n=this.validateFieldRule(e,s.elem,r,t);P(n)&&l.push(n)}),s.isValid&&this.setFieldValid(e,(i=s.config)==null?void 0:i.successMessage),Promise.allSettled(l).finally(()=>{var r;t&&((r=this.onValidateCallback)==null||r.call(this,{isValid:this.isFormValid(),isSubmitted:this.isSubmitted,fields:this.getCompatibleFields(),groups:{...this.groupFields}}))})}revalidateField(e){if(typeof e!="string"&&!N(e))throw Error("Field selector is not valid. Please specify a string selector or a valid DOM element.");const t=this.getKeyByFieldSelector(e);return!t||!this.fields[t]?(console.error("Field not found. Check the field selector."),Promise.reject()):new Promise(i=>{this.validateField(t,!0).finally(()=>{this.clearFieldStyle(t),this.clearFieldLabel(t),this.renderFieldError(t,!0),i(!!this.fields[t].isValid)})})}revalidateGroup(e){if(typeof e!="string"&&!N(e))throw Error("Group selector is not valid. Please specify a string selector or a valid DOM element.");const t=this.getKeyByFieldSelector(e);return!t||!this.groupFields[t]?(console.error("Group not found. Check the group selector."),Promise.reject()):new Promise(i=>{this.validateGroup(t).finally(()=>{this.clearFieldLabel(t),this.renderGroupError(t,!0),i(!!this.groupFields[t].isValid)})})}validateGroup(e,t=!1){const i=this.groupFields[e],s=[];return[...i.rules].reverse().forEach(l=>{const r=this.validateGroupRule(e,i.elems,l);P(r)&&s.push(r)}),Promise.allSettled(s).finally(()=>{var l;t&&((l=this.onValidateCallback)==null||l.call(this,{isValid:this.isFormValid(),isSubmitted:this.isSubmitted,fields:this.getCompatibleFields(),groups:{...this.groupFields}}))})}focusInvalidField(){for(const e in this.fields){const t=this.fields[e];if(!t.isValid){setTimeout(()=>t.elem.focus(),0);break}}}afterSubmitValidation(e=!1){this.renderErrors(e),this.globalConfig.focusInvalidField&&this.focusInvalidField()}validate(e=!1){return new Promise(t=>{const i=[];Object.keys(this.fields).forEach(s=>{const l=this.validateField(s);P(l)&&i.push(l)}),Object.keys(this.groupFields).forEach(s=>{const l=this.validateGroup(s);P(l)&&i.push(l)}),Promise.allSettled(i).then(()=>{var s;this.afterSubmitValidation(e),(s=this.onValidateCallback)==null||s.call(this,{isValid:this.isFormValid(),isSubmitted:this.isSubmitted,fields:this.getCompatibleFields(),groups:{...this.groupFields}}),t(!!i.length)})})}revalidate(){return new Promise(e=>{this.validateHandler(void 0,!0).finally(()=>{this.globalConfig.focusInvalidField&&this.focusInvalidField(),e(this.isValid)})})}validateHandler(e,t=!1){return this.globalConfig.lockForm&&this.lockForm(),this.validate(t).finally(()=>{var i,s,l;this.globalConfig.lockForm&&this.unlockForm(),this.isValid?((i=this.onSuccessCallback)==null||i.call(this,e),this.globalConfig.submitFormAutomatically&&((s=e==null?void 0:e.currentTarget)==null||s.submit())):(l=this.onFailCallback)==null||l.call(this,this.getCompatibleFields(),this.groupFields)})}setForm(e){this.form=e,this.form.setAttribute("novalidate","novalidate"),this.removeListener("submit",this.form,this.formSubmitHandler),this.addListener("submit",this.form,this.formSubmitHandler)}addListener(e,t,i){t.addEventListener(e,i),this.eventListeners.push({type:e,elem:t,func:i})}removeListener(e,t,i){t.removeEventListener(e,i),this.eventListeners=this.eventListeners.filter(s=>s.type!==e||s.elem!==t)}addField(e,t,i){if(typeof e!="string"&&!N(e))throw Error("Field selector is not valid. Please specify a string selector or a valid DOM element.");let s;if(typeof e=="string"?s=this.form.querySelector(e):s=e,!s)throw Error("Field doesn't exist in the DOM! Please check the field selector.");if(!Array.isArray(t)||!t.length)throw Error("Rules argument should be an array and should contain at least 1 element.");t.forEach(r=>{if(!("rule"in r||"validator"in r||"plugin"in r))throw Error("Rules argument must contain at least one rule or validator property.");if(!r.validator&&!r.plugin&&(!r.rule||!Object.values(y).includes(r.rule)))throw Error(`Rule should be one of these types: ${Object.values(y).join(", ")}. Provided value: ${r.rule}`)});const l=this.setKeyByFieldSelector(e);return this.fields[l]={elem:s,rules:t,isValid:void 0,touched:!1,config:i},this.setListeners(s),(this.isSubmitted||this.globalConfig.validateBeforeSubmitting)&&this.validateField(l),this}removeField(e){if(typeof e!="string"&&!N(e))throw Error("Field selector is not valid. Please specify a string selector or a valid DOM element.");const t=this.getKeyByFieldSelector(e);if(!t||!this.fields[t])return console.error("Field not found. Check the field selector."),this;const i=this.getListenerType(this.fields[t].elem.type);return this.removeListener(i,this.fields[t].elem,this.handlerChange),this.clearErrors(),delete this.fields[t],this}removeGroup(e){if(typeof e!="string")throw Error("Group selector is not valid. Please specify a string selector.");const t=this.getKeyByFieldSelector(e);return!t||!this.groupFields[t]?(console.error("Group not found. Check the group selector."),this):(this.groupFields[t].elems.forEach(i=>{const s=this.getListenerType(i.type);this.removeListener(s,i,this.handlerChange)}),this.clearErrors(),delete this.groupFields[t],this)}addRequiredGroup(e,t,i,s){if(typeof e!="string"&&!N(e))throw Error("Group selector is not valid. Please specify a string selector or a valid DOM element.");let l;if(typeof e=="string"?l=this.form.querySelector(e):l=e,!l)throw Error("Group selector not found! Please check the group selector.");const r=l.querySelectorAll("input"),n=Array.from(r).filter(a=>{const u=ge(this.groupFields,be(a));return u?u[1].elems.find(c=>c!==a):!0}),d=this.setKeyByFieldSelector(e);return this.groupFields[d]={rules:[{rule:_.Required,errorMessage:t,successMessage:s}],groupElem:l,elems:n,touched:!1,isValid:void 0,config:i},r.forEach(a=>{this.setListeners(a)}),this}getListenerType(e){switch(e){case"checkbox":case"select-one":case"file":case"radio":return"change";default:return"input"}}setListeners(e){const t=this.getListenerType(e.type);this.removeListener(t,e,this.handlerChange),this.addListener(t,e,this.handlerChange)}clearFieldLabel(e){var t,i;(t=this.errorLabels[e])==null||t.remove(),(i=this.successLabels[e])==null||i.remove()}clearFieldStyle(e){var t,i,s,l;const r=this.fields[e],n=((t=r.config)==null?void 0:t.errorFieldStyle)||this.globalConfig.errorFieldStyle;Object.keys(n).forEach(a=>{r.elem.style[a]=""});const d=((i=r.config)==null?void 0:i.successFieldStyle)||this.globalConfig.successFieldStyle||{};Object.keys(d).forEach(a=>{r.elem.style[a]=""}),r.elem.classList.remove(...x(((s=r.config)==null?void 0:s.errorFieldCssClass)||this.globalConfig.errorFieldCssClass),...x(((l=r.config)==null?void 0:l.successFieldCssClass)||this.globalConfig.successFieldCssClass))}clearErrors(){var e,t;Object.keys(this.errorLabels).forEach(i=>this.errorLabels[i].remove()),Object.keys(this.successLabels).forEach(i=>this.successLabels[i].remove());for(const i in this.fields)this.clearFieldStyle(i);for(const i in this.groupFields){const s=this.groupFields[i],l=((e=s.config)==null?void 0:e.errorFieldStyle)||this.globalConfig.errorFieldStyle;Object.keys(l).forEach(n=>{s.elems.forEach(d=>{var a;d.style[n]="",d.classList.remove(...x(((a=s.config)==null?void 0:a.errorFieldCssClass)||this.globalConfig.errorFieldCssClass))})});const r=((t=s.config)==null?void 0:t.successFieldStyle)||this.globalConfig.successFieldStyle||{};Object.keys(r).forEach(n=>{s.elems.forEach(d=>{var a;d.style[n]="",d.classList.remove(...x(((a=s.config)==null?void 0:a.successFieldCssClass)||this.globalConfig.successFieldCssClass))})})}this.tooltips=[]}isTooltip(){return!!this.globalConfig.tooltip}lockForm(){const e=this.form.querySelectorAll("input, textarea, button, select");for(let t=0,i=e.length;t<i;++t)e[t].setAttribute("data-just-validate-fallback-disabled",e[t].disabled?"true":"false"),e[t].setAttribute("disabled","disabled"),e[t].style.pointerEvents="none",e[t].style.webkitFilter="grayscale(100%)",e[t].style.filter="grayscale(100%)"}unlockForm(){const e=this.form.querySelectorAll("input, textarea, button, select");for(let t=0,i=e.length;t<i;++t)e[t].getAttribute("data-just-validate-fallback-disabled")!=="true"&&e[t].removeAttribute("disabled"),e[t].style.pointerEvents="",e[t].style.webkitFilter="",e[t].style.filter=""}renderTooltip(e,t,i){var s;const{top:l,left:r,width:n,height:d}=e.getBoundingClientRect(),a=t.getBoundingClientRect(),u=i||((s=this.globalConfig.tooltip)==null?void 0:s.position);switch(u){case"left":{t.style.top=`${l+d/2-a.height/2}px`,t.style.left=`${r-a.width-q}px`;break}case"top":{t.style.top=`${l-a.height-q}px`,t.style.left=`${r+n/2-a.width/2}px`;break}case"right":{t.style.top=`${l+d/2-a.height/2}px`,t.style.left=`${r+n+q}px`;break}case"bottom":{t.style.top=`${l+d+q}px`,t.style.left=`${r+n/2-a.width/2}px`;break}}return t.dataset.direction=u,{refresh:()=>{this.renderTooltip(e,t,i)}}}createErrorLabelElem(e,t,i){const s=document.createElement("div");s.innerHTML=t;const l=this.isTooltip()?i==null?void 0:i.errorLabelStyle:(i==null?void 0:i.errorLabelStyle)||this.globalConfig.errorLabelStyle;return Object.assign(s.style,l),s.classList.add(...x((i==null?void 0:i.errorLabelCssClass)||this.globalConfig.errorLabelCssClass),"just-validate-error-label"),this.isTooltip()&&(s.dataset.tooltip="true"),this.globalConfig.testingMode&&(s.dataset.testId=`error-label-${e}`),this.errorLabels[e]=s,s}createSuccessLabelElem(e,t,i){if(t===void 0)return null;const s=document.createElement("div");s.innerHTML=t;const l=(i==null?void 0:i.successLabelStyle)||this.globalConfig.successLabelStyle;return Object.assign(s.style,l),s.classList.add(...x((i==null?void 0:i.successLabelCssClass)||this.globalConfig.successLabelCssClass),"just-validate-success-label"),this.globalConfig.testingMode&&(s.dataset.testId=`success-label-${e}`),this.successLabels[e]=s,s}renderErrorsContainer(e,t){const i=t||this.globalConfig.errorsContainer;if(typeof i=="string"){const s=this.form.querySelector(i);if(s)return s.appendChild(e),!0;console.error(`Error container with ${i} selector not found. Errors will be rendered as usual`)}return i instanceof Element?(i.appendChild(e),!0):(i!==void 0&&console.error("Error container not found. It should be a string or existing Element. Errors will be rendered as usual"),!1)}renderGroupLabel(e,t,i,s){!s&&this.renderErrorsContainer(t,i)||e.appendChild(t)}renderFieldLabel(e,t,i,s){var l,r,n,d,a,u,c;if(!(!s&&this.renderErrorsContainer(t,i)))if(e.type==="checkbox"||e.type==="radio"){const g=document.querySelector(`label[for="${e.getAttribute("id")}"]`);((r=(l=e.parentElement)==null?void 0:l.tagName)==null?void 0:r.toLowerCase())==="label"?(d=(n=e.parentElement)==null?void 0:n.parentElement)==null||d.appendChild(t):g?(a=g.parentElement)==null||a.appendChild(t):(u=e.parentElement)==null||u.appendChild(t)}else(c=e.parentElement)==null||c.appendChild(t)}showLabels(e,t){Object.keys(e).forEach((i,s)=>{const l=e[i],r=this.getKeyByFieldSelector(i);if(!r||!this.fields[r]){console.error("Field not found. Check the field selector.");return}const n=this.fields[r];n.isValid=!t,this.clearFieldStyle(r),this.clearFieldLabel(r),this.renderFieldError(r,!1,l),s===0&&this.globalConfig.focusInvalidField&&setTimeout(()=>n.elem.focus(),0)})}showErrors(e){if(typeof e!="object")throw Error("[showErrors]: Errors should be an object with key: value format");this.showLabels(e,!0)}showSuccessLabels(e){if(typeof e!="object")throw Error("[showSuccessLabels]: Labels should be an object with key: value format");this.showLabels(e,!1)}renderFieldError(e,t=!1,i){var s,l,r,n,d,a;const u=this.fields[e];if(u.isValid===!1&&(this.isValid=!1),u.isValid===void 0||!t&&!this.isSubmitted&&!u.touched&&i===void 0)return;if(u.isValid){if(!u.asyncCheckPending){const g=this.createSuccessLabelElem(e,i!==void 0?i:u.successMessage,u.config);g&&this.renderFieldLabel(u.elem,g,(s=u.config)==null?void 0:s.errorsContainer,!0),u.elem.classList.add(...x(((l=u.config)==null?void 0:l.successFieldCssClass)||this.globalConfig.successFieldCssClass))}return}u.elem.classList.add(...x(((r=u.config)==null?void 0:r.errorFieldCssClass)||this.globalConfig.errorFieldCssClass));const c=this.createErrorLabelElem(e,i!==void 0?i:u.errorMessage,u.config);this.renderFieldLabel(u.elem,c,(n=u.config)==null?void 0:n.errorsContainer),this.isTooltip()&&this.tooltips.push(this.renderTooltip(u.elem,c,(a=(d=u.config)==null?void 0:d.tooltip)==null?void 0:a.position))}renderGroupError(e,t=!0){var i,s,l,r;const n=this.groupFields[e];if(n.isValid===!1&&(this.isValid=!1),n.isValid===void 0||!t&&!this.isSubmitted&&!n.touched)return;if(n.isValid){n.elems.forEach(u=>{var c,g;Object.assign(u.style,((c=n.config)==null?void 0:c.successFieldStyle)||this.globalConfig.successFieldStyle),u.classList.add(...x(((g=n.config)==null?void 0:g.successFieldCssClass)||this.globalConfig.successFieldCssClass))});const a=this.createSuccessLabelElem(e,n.successMessage,n.config);a&&this.renderGroupLabel(n.groupElem,a,(i=n.config)==null?void 0:i.errorsContainer,!0);return}this.isValid=!1,n.elems.forEach(a=>{var u,c;Object.assign(a.style,((u=n.config)==null?void 0:u.errorFieldStyle)||this.globalConfig.errorFieldStyle),a.classList.add(...x(((c=n.config)==null?void 0:c.errorFieldCssClass)||this.globalConfig.errorFieldCssClass))});const d=this.createErrorLabelElem(e,n.errorMessage,n.config);this.renderGroupLabel(n.groupElem,d,(s=n.config)==null?void 0:s.errorsContainer),this.isTooltip()&&this.tooltips.push(this.renderTooltip(n.groupElem,d,(r=(l=n.config)==null?void 0:l.tooltip)==null?void 0:r.position))}renderErrors(e=!1){if(!(!this.isSubmitted&&!e&&!this.globalConfig.validateBeforeSubmitting)){this.clearErrors(),this.isValid=!0;for(const t in this.groupFields)this.renderGroupError(t);for(const t in this.fields)this.renderFieldError(t)}}destroy(){this.eventListeners.forEach(e=>{this.removeListener(e.type,e.elem,e.func)}),Object.keys(this.customStyleTags).forEach(e=>{this.customStyleTags[e].remove()}),this.clearErrors(),this.globalConfig.lockForm&&this.unlockForm()}refresh(){this.destroy(),this.form?(this.initialize(this.form,this.globalConfig),Object.keys(this.fields).forEach(e=>{const t=this.getFieldSelectorByKey(e);t&&this.addField(t,[...this.fields[e].rules],this.fields[e].config)})):console.error("Cannot initialize the library! Form is not defined")}setCurrentLocale(e){if(typeof e!="string"&&e!==void 0){console.error("Current locale should be a string");return}this.currentLocale=e,this.isSubmitted&&this.validate()}onSuccess(e){return this.onSuccessCallback=e,this}onFail(e){return this.onFailCallback=e,this}onValidate(e){return this.onValidateCallback=e,this}}class B extends Error{constructor(e,...t){super(...t),this.name="UnhandledMatchError",this.message=`Unhandled match value of type ${typeof e} - ${e}`,Error.captureStackTrace(this,B)}}const G=Symbol();function ve(o){throw o}const ye=o=>ve(new B(o)),X=(o,e,t=ye)=>{const i=new Map,s=Array.isArray(e)?e:Object.entries(e).map(([r,n])=>[r,n]);for(const[...r]of s){const n=r.pop();for(const d of r.flat())i.has(d)||i.set(d,n)}i.has(G)||i.set(G,t);const l=i.get(o)??i.get(G);return typeof l=="function"?l(o):l};X.default=G;const Fe=(o,e)=>{const t=e.split(".");return o.elements.namedItem(t.reduce((i,s,l)=>l===0?s:`${i}[${s}]`,""))},W=o=>o.name.replace(/\[(\w+)\]/g,".$1");function Ce({form:o,rules:e={},customRules:t={},messages:i={},aliases:s={},globalConfig:l={}}){const r={errorFieldCssClass:["input-error","select-error"]},n=new me(o,{...r,...l}),d=b=>o.elements[b].value,a=(b,f)=>b.every(E=>f(d(E))),u=(b,f)=>b.some(E=>f(d(E)));function c(b){b.hasAttribute("hx-validate")&&b.addEventListener("htmx:confirm",function(f){f.detail.elt===b&&(f.preventDefault(),n.revalidateField(b).then(E=>{E&&f.detail.issueRequest()}))})}function g(b,f){Object.entries(b).forEach(([E,m])=>{const F=Fe(o,E);if(!F)return;const I=W(F)||"field",k=s[I]||I;let O=m.split("|").reduce((j,w)=>{const[K,C=""]=w.split(":");return j[K]=C.split(",").map(T=>T.trim()).filter(Boolean),j},{});const H=[],v=j=>H.push(j);Object.entries(O).forEach(([j,w])=>{const K=i[`${I}:${j}`],C=h=>K||`The ${k} ${h}`,T={rule:"required",errorMessage:C("is required")};X(j,{required:()=>{v(T)},required_if:()=>{const[h,...S]=w;S.includes(d(h))&&v(T)},required_unless:()=>{const[h,...S]=w;S.includes(d(h))||v(T)},required_with:()=>{u(w,Boolean)&&v(T)},required_without:()=>{u(w,h=>!h)&&v(T)},required_with_all:()=>{a(w,Boolean)&&v(T)},required_without_all:()=>{a(w,h=>!h)&&v(T)},email:()=>{v({rule:"email",errorMessage:C("is not valid email")})},uppercase:()=>{v({validator:h=>h===(h||"").toUpperCase(),errorMessage:C("must be uppercase")})},lowercase:()=>{v({validator:h=>h===(h||"").toLowerCase(),errorMessage:C("must be lowercase")})},json:()=>{v({validator:h=>{try{return typeof JSON.parse(h)=="object"}catch{return!1}},errorMessage:C("must be a valid JSON string")})},alpha:()=>{v({rule:"customRegexp",value:/^[A-Za-z]+$/,errorMessage:C("only allows alphabet characters")})},numeric:()=>{v({rule:"number",errorMessage:C("must be numeric")})},alpha_num:()=>{v({rule:"customRegexp",value:/^[A-Za-z0-9]+$/,errorMessage:C("must only contain letters and numbers")})},alpha_dash:()=>{v({rule:"customRegexp",value:/^[A-Za-z0-9_-]+$/,errorMessage:C("must only contain letters, numbers, dashes and underscores")})},alpha_spaces:()=>{v({validator:h=>/^[A-Za-z]+(?: [A-Za-z]+)*$/.test((h||"").trim()),errorMessage:C("must only contain letters and spaces")})},in:()=>{v({validator:h=>w.includes(h),errorMessage:C(`only allows ${w.join(",")}`)})},not_in:()=>{v({validator:h=>!w.includes(h),errorMessage:C(`is not allowing ${w.join(",")}`)})},min:()=>{const h=Number(w[0]);v({validator:S=>Array.isArray(S)?S.length>=h:F.type==="number"?parseFloat(S)>=h:(S||"").length>=h,errorMessage:C(`minimum is ${h}`)})},max:()=>{const h=Number(w[0]);v({validator:S=>Array.isArray(S)?S.length<=h:F.type==="number"?parseFloat(S)<=h:(S||"").length<=h,errorMessage:C(`maximum is ${h}`)})},between:()=>{const[h,S]=w.map(Number);v({validator:V=>{if(Array.isArray(V))return V.length>=h&&V.length<=S;if(F.type==="number"){const Y=parseFloat(V);return Y>=h&&Y<=S}const{length:Q}=V||"";return Q>=h&&Q<=S},errorMessage:C(`must be between ${h} and ${S}`)})},digits:()=>{const h=Number(w[0]);v({validator:S=>/^\d+$/.test(S)&&S.length===h,errorMessage:C(`must be numeric and have an exact length of ${h}`)})},digits_between:()=>{const[h,S]=w.map(Number);v({validator:V=>/^\d+$/.test(V)&&V.length>=h&&V.length<=S,errorMessage:C(`must have a length between ${h} and ${S}`)})},url:()=>{v({rule:"customRegexp",value:/^(https?|ftp):\/\/[^"]+$/,errorMessage:C("is not valid url")})},integer:()=>{v({rule:"integer",errorMessage:C("must be an integer")})},boolean:()=>{v({validator:h=>["true","false","1","0",!0,!1].includes(typeof h=="string"?h.toLowerCase():h),errorMessage:C("must be a boolean")})},array:()=>{v({validator:Array.isArray,errorMessage:C("must be an array")})},same:()=>{v({validator:h=>h===d(w[0]),errorMessage:C(`must be same as ${w[0]}`)})},regex:()=>{v({rule:"customRegexp",value:new RegExp(w[0]),errorMessage:C("is not valid format")})},date:()=>{v({validator:h=>!Number.isNaN(Date.parse(h)),errorMessage:C("is not a valid date")})},accepted:()=>{v({validator:h=>["yes","on","1","true",!0].includes(h),errorMessage:C("must be accepted")})},present:()=>{v({validator:()=>E in o.elements,errorMessage:C("must be present")})},different:()=>{v({validator:h=>h!==d(w[0]),errorMessage:C(`must be different from ${w[0]}`)})},after:()=>{v({validator:h=>new Date(h)>new Date(d(w[0])),errorMessage:C(`must be a date after ${w[0]}`)})},before:()=>{v({validator:h=>new Date(h)<new Date(d(w[0])),errorMessage:C(`must be a date before ${w[0]}`)})},nullable:()=>{},region_required:()=>{v({validator:h=>F.dataset.isRequired!=="true"||String(h).trim().length>0,errorMessage:C("is required")})}},()=>{const h=f[j];if(h){const S=h({addRule:v,params:w,input:F,dotName:I,inputLabel:k,errorMessage:C});S&&v(S)}})}),H.length>0&&(n.addField(F,H),c(F))})}return g(e,t),Object.assign(n,{rules:e,messages:i,aliases:s,applyRules:g,fieldHasRules(b){return!!this.rules[W(b)]},async validateFieldFor(b){if(!this.fieldHasRules(b))return!0;try{return await this.revalidateField(b)}catch{return!1}},async revalidateWithoutFocus(){const b=this.globalConfig.focusInvalidField;this.globalConfig.focusInvalidField=!1;const f=await this.revalidate();return this.globalConfig.focusInvalidField=b,f}})}window.mahxCheckout={validator:Ce,utils:{formDataJson:p}}})();
